services:
  gotify:
    image: "gotify/server:2.6.3"
    deploy:
      resources:
        limits:
          cpus: ${CPUS}
          memory: ${MEMORY_LIMIT}
    container_name: ${APP_NAME}
    restart: always
    networks:
      - baota_net
    ports:
      - "${WEB_PORT}:${GOTIFY_SERVER_PORT}"
    environment:
      - 'TZ=${TIME_ZONE}'
      - 'GOTIFY_SERVER_PORT=${GOTIFY_SERVER_PORT}'
      - 'GOTIFY_SERVER_KEEPALIVEPERIODSECONDS=${GOTIFY_SERVER_KEEPALIVEPERIODSECONDS}'
      - 'GOTIFY_SERVER_LISTENADDR=${GOTIFY_SERVER_LISTENADDR}'
      - 'GOTIFY_SERVER_SSL_ENABLED=${GOTIFY_SERVER_SSL_ENABLED}'
      - 'GOTIFY_SERVER_SSL_REDIRECTTOHTTPS=${GOTIFY_SERVER_SSL_REDIRECTTOHTTPS}'
      - 'GOTIFY_SERVER_SSL_LISTENADDR=${GOTIFY_SERVER_SSL_LISTENADDR}'
      - 'GOTIFY_SERVER_SSL_PORT=${GOTIFY_SERVER_SSL_PORT}'
      - 'GOTIFY_SERVER_SSL_CERTFILE=${GOTIFY_SERVER_SSL_CERTFILE}'
      - 'GOTIFY_SERVER_SSL_CERTKEY=${GOTIFY_SERVER_SSL_CERTKEY}'
      - 'GOTIFY_SERVER_SSL_LETSENCRYPT_ENABLED=${GOTIFY_SERVER_SSL_LETSENCRYPT_ENABLED}'
      - 'GOTIFY_SERVER_SSL_LETSENCRYPT_ACCEPTTOS=${GOTIFY_SERVER_SSL_LETSENCRYPT_ACCEPTTOS}'
      - 'GOTIFY_SERVER_SSL_LETSENCRYPT_CACHE=${GOTIFY_SERVER_SSL_LETSENCRYPT_CACHE}'
      - 'GOTIFY_SERVER_SSL_LETSENCRYPT_HOSTS=${GOTIFY_SERVER_SSL_LETSENCRYPT_HOSTS}'
      - 'GOTIFY_SERVER_RESPONSEHEADERS=${GOTIFY_SERVER_RESPONSEHEADERS}'
      - 'GOTIFY_SERVER_CORS_ALLOWORIGINS=${GOTIFY_SERVER_CORS_ALLOWORIGINS}'
      - 'GOTIFY_SERVER_CORS_ALLOWMETHODS=${GOTIFY_SERVER_CORS_ALLOWMETHODS}'
      - 'GOTIFY_SERVER_CORS_ALLOWHEADERS=${GOTIFY_SERVER_CORS_ALLOWHEADERS}'
      - 'GOTIFY_SERVER_STREAM_ALLOWEDORIGINS=${GOTIFY_SERVER_STREAM_ALLOWEDORIGINS}'
      - 'GOTIFY_SERVER_STREAM_PINGPERIODSECONDS=${GOTIFY_SERVER_STREAM_PINGPERIODSECONDS}'
      - 'GOTIFY_DATABASE_DIALECT=${GOTIFY_DATABASE_DIALECT}'
      - 'GOTIFY_DATABASE_CONNECTION=${GOTIFY_DATABASE_CONNECTION}'
      - 'GOTIFY_DEFAULTUSER_NAME=${GOTIFY_DEFAULTUSER_NAME}'
      - 'GOTIFY_DEFAULTUSER_PASS=${GOTIFY_DEFAULTUSER_PASS}'
      - 'GOTIFY_PASSSTRENGTH=${GOTIFY_PASSSTRENGTH}'
      - 'GOTIFY_UPLOADEDIMAGESDIR=${GOTIFY_UPLOADEDIMAGESDIR}'
      - 'GOTIFY_PLUGINSDIR=${GOTIFY_PLUGINSDIR}'
      - 'GOTIFY_REGISTRATION=${GOTIFY_REGISTRATION}'
    volumes:
      - ./data:/app/data
    labels:
      createdBy: "bt_apps"

networks:
  baota_net:
    external: true
